# üìö Oppimisp√§iv√§kirja

## üóìÔ∏è Syyskuu-Lokakuu 2024

### Viikko 38 - Projektin aloitus
#### üèóÔ∏è P√§√§komponenttien luonti
- Toteutettu projektin perusrakenne:
  - Navbar-komponentti
  - Highway-komponentti (my√∂hemmin uudelleennimetty)
- **Haaste**: Biome-tietojen n√§ytt√§minen valetietokannasta
- **Ratkaisu**: Dynaaminen toteutus
  1. Sivusto listaa biomet ID:n perusteella
  2. ID:t√§ klikkaamalla p√§√§see uudelle sivulle
  3. Uusi sivu n√§ytt√§√§ biomin sis√§ll√∂n
- **Opitut asiat**:
  - Dynaaminen reititys Angularissa
  - Tietorakenteiden suunnittelu
  - Komponenttien v√§linen kommunikaatio

### Projektin Kehitys

#### üìù Alkutila
![Projektin alkutilanne](C:\JAMK\Ticorporate\FortPolio\Kuvat\alkutilanne.png)

#### üìù Viikon Edistys
##### Toiminnallisuuden kehitys
- Ensimm√§inen toiminto toteutettu: biomien listaus valetietokannasta
- Toiminnallisuus demonstroitu kahdella n√§kym√§ll√§:
  1. ![Biomien listaus](C:\JAMK\Ticorporate\FortPolio\Kuvat\proto_biomes.png)
  2. ![Encounter-j√§rjestelm√§](C:\JAMK\Ticorporate\FortPolio\Kuvat\roll1.png)

##### Tietokantarakenne

- **Vale tietokanta**
  ``` typescript
  export class InMemoryService implements InMemoryDbService {
  createDb() {
    const highwayEncs = [
      {
        id: 1,
        name: 'Highwaymen',
        description: 'A group of bandits, armed to the teeth, are lying in wait to ambush unsuspecting travelers.'
      },
      // ... other highway encounters
    ];

    const dungeonEncs = [
      {
        id: 9,
        name: 'Injured Dungeoneer',
        description: 'An injured dungeoneer is limping around the dungeon and needs medical attention'
      },
      // ... other dungeon encounters
    ];

    const wildernessEncs = [
      {
        id: 12,
        name: 'Owlbear',
        description: 'An Owlbear is heard rummaging through the bushes nearby'
      },
      // ... other wilderness encounters
    ];

    return { highwayEncs, dungeonEncs, wildernessEncs };
  }
}

### Viikko 39
- Valtion virallinen kertausharjoitus

### Viikko 40 - Modaalit ja tietokantaintegraatio
#### üé≤ Modaalien toteutus
- Enctable-komponentin modaalit:
  - Nopanheiton tulosten n√§ytt√§minen
  - Satunnaisten kohtaamisten esitt√§minen
  - Yksitt√§isten kohtaamisten tarkastelu

#### üîå Backend-integraatio
- Frontend yhdistetty backendiin
  - Valetietokannan ongelmat ratkaistu
  - Tiedonkulku optimoitu

#### üíæ MongoDB Atlas -migraatio
- Tietokanta siirretty pilveen
  - Docker-riippuvuudesta luovuttu
  - Yhteys tietokantaan pilvipalvelun kautta

#### üõ†Ô∏è Uudet toiminnallisuudet
- Aloitettu CRUD-operaatioiden toteutus:
  - Edit-toiminnallisuus
  - Delete-toiminnallisuus

## üóìÔ∏è Marraskuu 2024

## 18.11.2024 - Encountereiden tallennus
---

üéØ **Saavutus**: Encountereiden tallennus saatu toimivaksi pitk√§n ty√∂st√§misen j√§lkeen.

#### üí° Tekninen oivallus:
Ongelma oli tietokannan `saveEnc`-metodissa. Alkuper√§inen koodi:
```javascript
_id: req.params.biomeId,
'enc.name': req.body.name  // T√§m√§ esti encounterin nimen p√§ivittymisen
```

**Miksi t√§m√§ oli ongelma?**
- Toiminto m√§ts√§√§ tallennettavan encounterin nimen
- Jos nimi on muuttunut, haku ei l√∂yd√§ dokumenttia
- Ehto etsii enci√§, jonka nimi vastaa uutta nime√§

#### ‚úÖ Ratkaisu:
```javascript
_id: req.params.biomeId,
'enc._id': req.body._id  // Nyt l√∂ytyy aina ID:n perusteella
```

**Loppuviikon teht√§v√§t:**
- Toiminnon implementointi
- Demon toiminnallisuuden varmistaminen

### 22.11.2024 - Demo ja palaute
---

üéì **Demo-arvosana**: 3

#### üìù Kehityskohteet seuraavaan demoon:
1. Syv√§llisempi analyysi ongelmatilanteista
   - Mit√§ ongelmia kohdattiin?
   - Miksi ne ilmeniv√§t?
   - Miten ne ratkaistiin?
2. Selke√§mpi esittely tehdyist√§ asioista
3. Ty√∂skentelytapojen avaaminen
4. Loppupohdinta
   - Mik√§ meni hyvin?
   - Mik√§ meni huonosti?

## 25.11.2024 - üîê Google-kirjautuminen ja tavallinen kirjautuminen
---
## Tavoitteet Google-kirjautumiselle toteuttamiselle:
- Tehd√§ login-sivu
- 

## Tavoitteet tavallisen kirjautumisen toteuttamiselle:

üåü **Viikon aloitus**: Positiivinen palaute motivoi ty√∂skentely√§!

#### üîç Pohdinta aiheesta: Google-kirjautuminen:
- Aloitettu Tuikan tutoriaalin pohjalta
- Haaste: Esimerkkikoodin soveltaminen omaan projektiin
- Oppimiskokemus: Koodin soveltaminen vaatii syv√§llist√§ ymm√§rryst√§

#### üîç Pohdinta aiheesta: Tavallinen kirjautuminen:
- Kaikki olikin jo valmiina, kun koodi oltiin tehty backend1 tunnilla
- Tarvitsi ainoastaan luoda tunnarit tietokantaan ja homma pelitti

### üîê Google-kirjautumisen toteutus

#### 1. Projektin alustus
- Pohja otettu tutoriaali-teht√§v√§st√§
- Asennettu tarvittava paketti: `@abacritt/angularx-social-login`

#### 2. Abacritt-kirjasto
> Avoimen l√§hdekoodin Angular-kirjasto sosiaalisen median kirjautumisille
- Tukee useita kirjautumistapoja (Google, Facebook)
- Automatisoi:
  - Kirjautumisprosessin
  - K√§ytt√§j√§tietojen haun
  - Istunnonhallinnan
- Yksinkertaistaa integraation toteutusta

#### 3. Konfiguraatio (`app.config.ts`)
```typescript
import { NgModule } from '@angular/core';
import { FormsModule } from '@angular/forms';
import { SocialLoginModule, GoogleSigninButtonModule } from '@abacritt/angularx-social-login';
import { JwtModule } from '@auth0/angular-jwt';

@NgModule({
  imports: [
    FormsModule,
    SocialLoginModule,
    GoogleSigninButtonModule,
    JwtModule.forRoot({
      config: {
        tokenGetter: tokenGetter,
        allowedDomains: ['localhost:4200'],
        disallowedRoutes: []
      }
    })
  ]
})
export class AppModule {}
```

#### 4. Komponenttien selitykset

##### üì¶ Moduulit
- **SocialLoginModule**
  - Hallinnoi Googlen kirjautumisprosessia
  - K√§sittelee autentikaation logiikan

- **GoogleSigninButtonModule**
  - Tarjoaa valmiin Google-kirjautumispainikkeen
  - Noudattaa Googlen br√§nd√§ysohjeita

##### üîí JWT-autentikaatio
- **JwtModule.forRoot()**
  - Hallinnoi JWT-pohjaista autentikaatiota
  - Konfiguraation osat:
    - `tokenGetter`: Hakee JWT-tokenin
    - `allowedDomains`: M√§√§ritt√§√§ sallitut domainit (`localhost:4200`)
    - `disallowedRoutes`: M√§√§ritt√§√§ kielletyt reitit

#### 4. Frontend-toteutus

##### üñ•Ô∏è Kirjautumiskomponentit
- **LoginComponent**
  - K√§sittelee sek√§ Google- ett√§ tavallisen kirjautumisen
  - Sis√§lt√§√§ kirjautumislomakkeen ja Google-kirjautumispainikkeen
  - Ohjaa k√§ytt√§j√§n dashboardille onnistuneen kirjautumisen j√§lkeen

##### üîê AuthService
```typescript
// Tavallinen kirjautuminen
login(username: string, password: string): Observable<boolean> {
  return this.http.post(this.basicLoginUrl, { username, password })
    .pipe(map((res: any) => {
      const token = res['token'];
      if (token) {
        this.token = token;
        sessionStorage.setItem('accesstoken', token);
        return true;
      }
      return false;
    }));
}

// Google-kirjautuminen
glogin(gtoken: string): Observable<boolean> {
  return this.http.post(this.googleLoginUrl, { gtoken })
    .pipe(map((res: any) => {
      const token = res['token'];
      if (token) {
        sessionStorage.setItem('accesstoken', token);
        return true;
      }
      return false;
    }));
}
```

##### üõ°Ô∏è Reittien suojaus
- Toteutettu `authGuard`-funktionaalisella guardilla
  1. Tarkistaa jokaisen suojatun reitin kohdalla, onko k√§ytt√§j√§ kirjautunut sis√§√§n
  2. Jos k√§ytt√§j√§ll√§ on voimassa oleva token sessionStoragessa, sallii p√§√§syn reitille
  3. Jos tokenia ei ole tai se on vanhentunut, ohjaa k√§ytt√§j√§n automaattisesti login-sivulle
  4. Toimii "portinvartijana" kaikille suojatuille reiteille, kuten dashboard, retables ja merchants

Esimerkki suojatuista reiteist√§:
```typescript
export const routes: Routes = [
  // Julkiset reitit
  { path: 'login', component: LoginComponent },
  { path: '', redirectTo: 'login', pathMatch: 'full' },
  
  // Suojatut reitit (vaativat kirjautumisen)
  { 
    path: 'dashboard', 
    component: KaruselliComponent,
    canActivate: [authGuard]  // Tarkistaa kirjautumisen
  },
  { 
    path: 'retables', 
    component: RetablesComponent,
    canActivate: [authGuard]  // Tarkistaa kirjautumisen
  }
]
```

#### 5. Backend-toteutus

### üì¶ MongoDB User-malli

K√§ytt√§j√§skeema m√§√§rittelee sovelluksen k√§ytt√§j√§n tietorakenteen:

- `username`: K√§ytt√§j√§n uniikki tunniste, jota k√§ytet√§√§n kirjautumiseen
- `password`: K√§ytt√§j√§n salasana (huom: tallennetaan salattuna)
- `isadmin`: M√§√§ritt√§√§ k√§ytt√§j√§n yll√§pito-oikeudet

```typescript
const UserSchema = new mongoose.Schema({
  username: { type: String, unique: true, required: true },
  password: { type: String, required: true },
  isadmin: { type: Boolean, required: true },
});
```

### 29.11.2024 - 09.12.2024
--- Kertausharjoitus, eli olen poissa ja palaan 09.12.2024. takaisin ---
- T√§m√§n j√§lkeen, pyrit√§√§n suorittamaan seuraavat teht√§v√§t:
  1. Kirjautumisprosessin toteuttaminen loppuun - Kirjautumistietojen tallennus tietokantaan
  2. Selvitys LocalStoragen k√§ytt√∂√∂notosta
  3. PWAn buildaus

## üéØ Loppureflektio ja Ammatillinen Kehitys

### üíº P√§√§- ja sivuty√∂n n√§kyvyys projektissa
- **P√§√§ty√∂ (TC Dungeon Helper)**
  - Vastuualueeni FullStack -kehityksess√§
  - Merchant ja Random Encounters -toiminnallisuudet

- **Sivuty√∂ (Portfolio)**
  - Dokumentointi ja oppimisp√§iv√§kirjan yll√§pito
  - Koodin laadun varmistaminen ja refaktorointi
  - Tiimin sis√§inen mentorointi ja tuki
  - Autentikaation toteutus (Google-kirjautuminen ja perinteinen kirjautuminen)

### üåü Oppimiskokemukset ja oivallukset
- **Tekniset taidot**
  - Angular-osaamisen syventyminen
  - Autentikaation ja k√§ytt√§j√§hallinnan ymm√§rrys
  - REST API -integraatiot
  - Git-ty√∂skentelyn tehostuminen

- **Pehme√§t taidot**
  - Tiimity√∂skentelyn merkitys projektin onnistumisessa
  - Kommunikaatiotaitojen kehittyminen
  - Ongelmienratkaisukyvyn vahvistuminen
  - Itsen√§isen ty√∂skentelyn ja ajank√§yt√∂n hallinta

### üéØ Tavoitteiden toteutuminen
- **Saavutetut tavoitteet**
  - Toimiva autentikaatioj√§rjestelm√§
  - Merchant-toiminnallisuuden perustoiminnot
  - Responsiivinen k√§ytt√∂liittym√§
  
- **Jatkokehityskohteet**
  - K√§ytt√§j√§kokemusten ker√§√§minen ja analysointi
  - Testikattavuuden parantaminen
  - Suorituskyvyn optimointi

### üí° Suunnitelman ulkopuoliset opit
- MongoDB Atlas -integraation haasteet ja ratkaisut
- Angular Material -kirjaston tehokas hy√∂dynt√§minen
- JWT-tokenien k√§ytt√∂ autentikaatiossa
- Vierask√§ytt√§j√§-toiminnallisuuden toteutus

### üîÆ Tulevaisuuden n√§kym√§t
- **Uratoiveet**
  - Frontend-kehitt√§j√§n rooli modernissa ohjelmistotalossa
  - Mahdollisuus ty√∂skennell√§ monipuolisten web-sovellusten parissa
  - Kiinnostus UI/UX-suunnitteluun

- **Opintojakson tuki tavoitteille**
  - K√§yt√§nn√∂n kokemusta modernista web-kehityksest√§
  - Ymm√§rrys full stack -kehityksen periaatteista
  - Tiimity√∂skentelyn ja projektinhallinnan taidot

### üéØ Kehityskohteet
- **Tarvittava lis√§osaaminen**
  - Testausautomaation syvent√§minen
  - State management -ratkaisujen (NgRx) opettelu
  - UI/UX-suunnittelun periaatteiden vahvistaminen
  - DevOps-ty√∂kalujen hallinta

### üí™ Vahvuudet
- Nopea oppimiskyky uusien teknologioiden kanssa
- Kyky ty√∂skennell√§ itsen√§isesti ja tiimiss√§
- Ongelmienratkaisukyky ja sinnikkyys
- Dokumentoinnin ja koodin laadun arvostaminen

### üìö Portfolio-valintojen perusteet
- Dokumentit osoittavat teknisen osaamisen kehityksen
- Koodiesimerkit demonstroivat ongelmanratkaisutaitoja
- Oppimisp√§iv√§kirja kuvastaa reflektointikyky√§ ja ammatillista kasvua
- Valitut ty√∂t edustavat monipuolista osaamista web-kehityksess√§
